<!DOCTYPE html>
<html>
<head>
  <title>User Profile</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
<div class="container">
  <h2 id="username"></h2>
  <div id="profile"></div>
  <a href="index.html">Back to Forum</a>
</div>
<script src="js/api.js"></script>
<script>
const params = new URLSearchParams(window.location.search);
const user = params.get("username");

function renderBadges(badges) {
  if (!badges || badges.length === 0) return "";
  return "<b>Badges:</b> " + badges.map(b => `<span class="badge">${b}</span>`).join(" ");
}

api("/users/" + encodeURIComponent(user))
  .then(res => {
    if (res.error) {
      document.getElementById("profile").innerText = res.error;
      document.getElementById("username").innerText = "User not found";
      return;
    }
    document.getElementById("username").innerText = res.username;
    document.getElementById("profile").innerHTML = `
      <div><b>Joined:</b> ${new Date(res.join_date).toLocaleDateString()}</div>
      <div><b>Last online:</b> ${new Date(res.last_online).toLocaleString()}</div>
      <div>${renderBadges(JSON.parse(res.badges || "[]"))}</div>
    `;
  });
</script>
<style>
.badge {
  display: inline-block;
  background: #eee;
  border-radius: 5px;
  padding: 2px 7px;
  margin: 2px 4px;
  font-size: 0.9em;
  border: 1px solid #ccc;
}
</style>
</body>
</html>
